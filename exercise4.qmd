---
title: "exercise4"
author: "Kendall Beaver"
format: html
editor: visual
---

```{r}

install.packages("ggplot2")
library(ggplot2)
library(tibble)
library(rsample)
library(parsnip)
library(dplyr)

##################################
#
# Generate Synthetic Attributes
#
##################################

# parameters
seed <- 1            # seed for random number generation 
numInstances <- 200  # number of data instances

# Set seed
set.seed(seed)

# Generate data
X <- matrix(runif(numInstances), ncol=1)
y_true <- -3*X + 1 
y <- y_true + matrix(rnorm(numInstances), ncol=1)

# Plot
ggplot() +
  geom_point(aes(x=X, y=y), color="black") +
  geom_line(aes(x=X, y=y_true), color="blue", linewidth=1) +
  ggtitle('True function: y = -3X + 1') +
  xlab('X') +
  ylab('y')

```

```{r}
#######################################################
# Step 1: Split Input Data into Training and Test Sets
#######################################################

# Train/test split
numTrain <- 20   # number of training instances
numTest <- numInstances - numTrain

set.seed(123) # For reproducibility

data <- tibble(X = X, y = y)

split_obj <- initial_split(data, prop = numTrain/numInstances)

# Extract train and test data
train_data <- training(split_obj)
test_data <- testing(split_obj)

# Extract X_train, X_test, y_train, y_test
X_train <- train_data$X
y_train <- train_data$y

X_test <- test_data$X
y_test <- test_data$y
```

```{r}

######################################################
# Step 2: Fit/Create Regression Model to Training Set
######################################################

# Create a linear regression model specification
lin_reg_spec <- linear_reg() |> # This just contains info that says "lm".
  set_engine("lm")

# Fit the model to the training data
lin_reg_fit <- lin_reg_spec |> ### So this is OUR training model.
  fit(y ~ X, data = train_data)
```

```{r}

################################################
# Step 3: Apply Model to the Test Set
################################################

# Apply model to the test set
y_pred_test <- predict(lin_reg_fit, new_data = test_data) |>
  pull(.pred) # This generates 180 predicted target/y-values.
```

```{r}

#################################################
# Step 4: Evaluate Model Performance on Test Set (Visually)
#################################################

# Plotting true vs predicted values
ggplot() + 
  geom_point(aes(x = as.vector(y_test), y = y_pred_test), color = 'black') +
  ggtitle('Comparing true and predicted values for test set') +
  xlab('True values for y') +
  ylab('Predicted values for y')
```
