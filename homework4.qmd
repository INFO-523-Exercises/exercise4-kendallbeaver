---
title: "homework4"
format: html
editor: visual
---

```{r}

#################
# Load packages
#################

install.packages("ggplot2")
install.packages("DescTools")
install.packages("gridExtra")
install.packages("tune", repos = "http://cran.r-project.org")

pacman::p_load(dlookr,
               tidyverse,
               here,
               formattable,
               knitr,
               dplyr)

library(ggplot2)
library(tibble)
library(rsample)
library(parsnip)
library(dplyr)
library(Metrics)
library(caret)
library(DescTools)
library(gridExtra)
library(recipes)
library(magrittr)
library(here)
```

```{r}
##################################
# Load & analyze "Cage Free" data
##################################

# Original dimensions of dataset: 96 rows x 4 columns
original_data <- read_csv(here('./data/cage-free-percentages.csv'), col_types = cols(observed_month = col_date(),
  percent_hens = col_double(),
  percent_eggs = col_double(),
  observed_month = col_date()
))

# Removing unncessary "source" column
cage_free <- original_data %>% select(-source)

# Timespan of data: Over 13 yrs worth of data
cage_free |> summary()

# Presentable view of dataset
cage_free |> formattable()

#Summary: Data is limited; numbers are percentages and missing values.
```

```{r}
######################################
# Load & analyze "Egg Production" data
######################################

# Original dimensions of dataset: 220 rows x 6 columns
original_egg_prod_data <- read_csv(here('./data/egg-production.csv'), col_types = cols(observed_month = col_date(),
  prod_type = col_factor(),
  prod_process = col_factor(),
  n_hens = col_double(),
  n_eggs = col_double()
))

# Removing unncessary "source" column
egg_prod <- original_egg_prod_data %>% select(-source)
#egg_prod

# Timespan of data: Over 13 yrs worth of data
egg_prod |> summary()

# Presentable view of dataset
egg_prod |> 
  filter() |>
  formattable()

# "Hatching eggs" will impede production, so filtering for "table eggs" 
filtered_eggs_prod <- egg_prod %>%
  filter(prod_type %in% "table eggs") %>%
  filter(prod_process %in% "all")

# "Table eggs" dataset from 7/31/16 - 1/31/21
filtered_eggs_prod |> formattable()

# Create plot: First, create short-hand notaion for the x- & y-axis
x <- filtered_eggs_prod$n_hens
y <- filtered_eggs_prod$n_eggs

# Create plot: Second, plot the vectors
plot(x, y,
     xlab = "No. of Hens", 
     ylab = "No. of Eggs",
     main = "Scatter Plot of Table Egg Production from July 2016 - Jan. 2021")

# Assuming your_data is your data frame and x_column, y_column are your column names
linear_model <- lm(y_column ~ x_column, data = your_data)

# Print the summary of the linear model
summary(linear_model)

```

```{r}

##################################
#
# Generate Synthetic Attributes
#
##################################

# parameters
seed <- 1            # seed for random number generation 
numInstances <- 200  # number of data instances

# Set seed
set.seed(seed)

# Generate data
X <- matrix(runif(numInstances), ncol=1)
y_true <- -3*X + 1 
y <- y_true + matrix(rnorm(numInstances), ncol=1)

# Plot
ggplot() +
  geom_point(aes(x=X, y=y), color="black") +
  geom_line(aes(x=X, y=y_true), color="blue", linewidth=1) +
  ggtitle('True function: y = -3X + 1') +
  xlab('X') +
  ylab('y')
```
